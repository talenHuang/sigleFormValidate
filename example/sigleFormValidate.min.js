(function(c,a){var b=function(){this.custom={},this.type={},this.defaultType={"int":{defaultMsg:"该项只能为数字",reg:/^\d+$/},"phone":{defaultMsg:"手机号不正确",reg:/^1[3-9][0-9]{9}$/},};this.all_doms=null;this.scope=a;this.counter=0;this.errorArray=[]};b.prototype={buildRelatedMethods:function(){var d=this;Object.keys(d.type).forEach(function(e){d[e+"Validate"]=new Function("e","type","var $target = this;"+'                var msg = e.getAttribute("s-"+type+"-msg") || $target.type[type].defaultMsg;\n'+"                    if ($target.type[type].reg.test(e.value)) {\n"+"                        $target.removeErrorMsg(e, type)\n"+"                    } else {\n"+"                        $target.appendErrorMsg(e, msg, type);\n"+"                }")})},init:function(e,d){var g=this;var e=e||"body";g.type=Object.assign(g.defaultType,g.custom);g.scope=e;g.buildRelatedMethods();if(d!==null&&typeof d==="function"){g.appendErrorMsg=d}g.all_doms=a.querySelectorAll(e+" input");var f=a.querySelector(e);f.addEventListener("change",function(h){g.sortValidate(h.target)});f.addEventListener("keydown",function(h){g.sortValidate(h.target)});f.addEventListener("keyup",function(h){g.sortValidate(h.target)});f.addEventListener("blur",function(h){g.sortValidate(h.target)})},sortValidate:function(i){var k=this;var g=i.attributes;if(i.value===""){if(i.getAttribute("s-req")!==null){k.removeAllErrorMsg(i);k.reqValidate(i)}}else{for(var f=0,e=g.length;f<e;f++){if(/^s-\w+$/.test(g[f].name)){var h=(g[f].name.split("")).splice(2);var d=h.join("");k[d+"Validate"].call(k,i,d)}}}},reqValidate:function(g){var f=this;var d=g.getAttribute("s-req-msg")||"该项不能为空";if(g.value===""&&g.getAttribute("s-req")!==null){f.appendErrorMsg(g,d,"req")}else{f.removeErrorMsg(g,"req")}},maxValidate:function(h){var d=h.getAttribute("s-max");var g=this;var f=h.getAttribute("s-max-msg")||"该项最大值不超过"+d+"个字符";if(h.value.length>d){g.appendErrorMsg(h,f,"max")}else{g.removeErrorMsg(h,"max")}},minValidate:function(h){var d=h.getAttribute("s-min");var g=this;var f=h.getAttribute("s-min-msg")||"该项不低于"+d+"个字符";if(h.value.length<d){g.appendErrorMsg(h,f,"max")}else{g.removeErrorMsg(h,"max")}},compareValidate:function(h){var f=h.getAttribute("s-compare");var g=this;var d=h.getAttribute("s-compare-msg")||"两项比较不一致";var i=a.querySelector(f);if(h.value!==i.value){g.appendErrorMsg(h,d,"max")}else{g.removeErrorMsg(h,"max")}},appendErrorMsg:function(h,i,d){var g=this;var f=a.createElement("span");f.style.color="red";f.style.display="block";f.style.fontSize="12px";f.className="s-err-msg";f.textContent=i;f.setAttribute("data-flag",d);g.removeAllErrorMsg(h,d);h.insertAdjacentElement("afterend",f)},removeAllErrorMsg:function(h,d){var g=this;var f=g.findNextErrorElement(h);if(f&&f.length){f.forEach(function(e){if(d&&e.dataset.flag===d){e.remove()}else{e.remove()}})}},removeErrorMsg:function(h,d){var g=this,f;g.errorArray=[];f=g.findNextErrorElement(h);f.forEach(function(e){if(e.dataset.flag===d){e.remove()}})},findNextErrorElement:function(f){var d=this;if(f.nextElementSibling&&f.nextElementSibling.classList.contains("s-err-msg")){d.errorArray.push(f.nextElementSibling);return d.findNextErrorElement(f.nextElementSibling)}else{return d.errorArray}},validate:function(){var e=this;var d=a.querySelector(e.scope).querySelectorAll("input[s-req]");d.forEach(function(f){e.sortValidate(f)});e.counter=a.querySelector(e.scope).getElementsByClassName("s-err-msg").length;return e.counter===0?true:false}};c.Sfv=b})(window,document);